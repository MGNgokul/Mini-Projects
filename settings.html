<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Settings | SkillVault</title>

<link rel="icon" type="image/png" href="https://static.vecteezy.com/system/resources/previews/011/482/188/non_2x/driving-school-logo-design-steering-wheel-with-cog-and-book-icon-free-vector.jpg">

<style>
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  font-family:'Segoe UI', sans-serif;
}

body{
  background:#f4f6f9;
  min-height:100vh;
}

body.dark{
  background:#1e1e2f;
  color:white;
}

.navbar{
  background:#1e1e2f;
  color:#4db5ff;
  padding:15px 25px;
  font-size:20px;
  font-weight:bold;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.back-btn{
  background:#4db5ff;
  border:none;
  padding:8px 15px;
  border-radius:8px;
  color:white;
  cursor:pointer;
}

.container{
  max-width:800px;
  margin:40px auto;
  padding:20px;
}

.card{
  background:white;
  padding:25px;
  border-radius:10px;
  box-shadow:0 5px 15px rgba(0,0,0,0.1);
  margin-bottom:25px;
}

body.dark .card{
  background:#2c2c3e;
}

.card h3{
  margin-bottom:20px;
}

.option{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:15px;
}

input[type="checkbox"]{
  width:18px;
  height:18px;
}

input[type="password"]{
  width:100%;
  padding:10px;
  margin-bottom:10px;
  border-radius:6px;
  border:1px solid #ccc;
}

button.primary{
  background:#4db5ff;
  border:none;
  padding:10px 18px;
  color:white;
  border-radius:6px;
  cursor:pointer;
}

button.primary:hover{
  background:#1e1e2f;
}

.error{
  color:red;
  font-size:13px;
  margin-bottom:10px;
}

.success{
  color:green;
  font-size:13px;
  margin-bottom:10px;
}
</style>
</head>

<body>

<div class="navbar">
  SkillVault - Settings
  <button class="back-btn" onclick="goDashboard()">← Dashboard</button>
</div>

<div class="container">

  <!-- Preferences -->
  <div class="card">
    <h3>Preferences</h3>

    <div class="option">
      <label>Dark Mode</label>
      <input type="checkbox" id="darkMode">
    </div>

    <div class="option">
      <label>Email Notifications</label>
      <input type="checkbox" id="emailNotify" checked>
    </div>
  </div>

  <!-- Change Password -->
  <div class="card">
    <h3>Change Password</h3>

    <div id="msg"></div>

    <input type="password" id="currentPass" placeholder="Current Password">
    <input type="password" id="newPass" placeholder="New Password">
    <input type="password" id="confirmPass" placeholder="Confirm Password">

    <button class="primary" onclick="updatePassword()">Update Password</button>
  </div>

</div>

<script>

/* Load Saved Settings */
window.onload = function(){
  const settings = JSON.parse(localStorage.getItem("settings"));
  if(settings){
    darkMode.checked = settings.dark;
    emailNotify.checked = settings.email;
    if(settings.dark){
      document.body.classList.add("dark");
    }
  }
};

/* Save Preferences */
darkMode.addEventListener("change", saveSettings);
emailNotify.addEventListener("change", saveSettings);

function saveSettings(){
  const settings = {
    dark: darkMode.checked,
    email: emailNotify.checked
  };

  localStorage.setItem("settings", JSON.stringify(settings));

  document.body.classList.toggle("dark", darkMode.checked);
}

/* Change Password Validation */
function updatePassword(){

  const current = currentPass.value.trim();
  const newP = newPass.value.trim();
  const confirm = confirmPass.value.trim();
  const strong = /^(?=.*[A-Z])(?=.*[a-z])(?=.*\d).{6,}$/;

  msg.innerHTML = "";

  if(current === "" || newP === "" || confirm === ""){
    msg.innerHTML = "<div class='error'>All fields are required</div>";
    return;
  }

  let user = JSON.parse(localStorage.getItem("skillvaultUser"));

  if(!user || current !== user.password){
    msg.innerHTML = "<div class='error'>Current password incorrect</div>";
    return;
  }

  if(!strong.test(newP)){
    msg.innerHTML = "<div class='error'>Min 6 chars, 1 uppercase, 1 number</div>";
    return;
  }

  if(newP !== confirm){
    msg.innerHTML = "<div class='error'>Passwords do not match</div>";
    return;
  }

  user.password = newP;
  localStorage.setItem("skillvaultUser", JSON.stringify(user));

  msg.innerHTML = "<div class='success'>Password Updated Successfully ✅</div>";

  currentPass.value="";
  newPass.value="";
  confirmPass.value="";
}

/* Back Button */
function goDashboard(){
  window.location.href = "dashboard.html";
}

</script>

</body>
</html>
